================================================================================
                    PR #4 FEATURE CHANGES REPORT
                    "Updates By TripleU"
                    By: TripleU613
                    Date: 2025-11-06
================================================================================

SUMMARY
-------
This PR makes significant changes to the app, including:
- Rebranding from "Metrolist" to "Zemer"
- Removing online search functionality (YouTube Music search)
- Simplifying the build system (removing ABI variants)
- Replacing Guava library with AndroidX alternatives
- Stripping video playback capabilities (audio-only)
- Reducing localization support
- Removing splash screen skip option
- Significantly reducing ProGuard rules


================================================================================
                        MAJOR FEATURES REMOVED
================================================================================

1. ONLINE SEARCH FEATURE (YouTube Music Search)
   ---------------------------------------------
   REMOVED: Ability to search YouTube Music directly from the app

   What was removed:
   - Search source toggle (Local/Online switch)
   - OnlineSearchScreen.kt (entire online search UI)
   - SearchSource enum and SearchSourceKey preference
   - Toggle button in search bar to switch between local/online search
   - "Search YouTube Music" functionality

   What remains:
   - Only LOCAL library search is available now
   - Users can only search their downloaded/cached music

   Impact: MAJOR - Users cannot discover new music through search anymore


2. MULTI-ABI BUILD VARIANTS
   -------------------------
   REMOVED: Separate builds for different CPU architectures

   What was removed:
   - arm64 variant (ARM 64-bit only)
   - armeabi variant (ARM 32-bit only)
   - x86 variant (x86 32-bit only)
   - x86_64 variant (x86 64-bit only)

   What remains:
   - Only "universal" variant (includes all ABIs in one APK)

   Impact: MEDIUM - Larger APK size (users download all ABIs instead of their device's ABI)


3. SPLASH SCREEN SKIP BUTTON
   --------------------------
   REMOVED: "Load in background" button on splash screen

   What was removed:
   - Skip button that allowed users to bypass whitelist sync
   - Ability to use app while whitelist syncs in background
   - Artist name display during sync
   - "current/total" progress counter

   What changed:
   - Progress now shows as percentage (0-100%)
   - Splash screen is now MANDATORY - cannot be skipped

   Impact: MEDIUM - Users must wait for whitelist sync on every launch


4. MULTI-LANGUAGE SUPPORT
   -----------------------
   REMOVED: Store metadata for 26+ languages

   Languages removed:
   - Arabic (ar)
   - Azerbaijani (az-AZ)
   - Bulgarian (bg)
   - Catalan (ca)
   - Czech (cs-CZ)
   - German (de-DE)
   - Spanish (es)
   - Estonian (et)
   - Basque (eu-ES)
   - Filipino (fil)
   - French (fr-FR)
   - Indonesian (id)
   - Italian (it)
   - Korean (ko-KR)
   - Mauritian Creole (mfe)
   - Portuguese - Brazil (pt-BR)
   - Portuguese (pt)
   - Romanian (ro)
   - Russian (ru-RU)
   - Slovak (sk)
   - Slovenian (sl)
   - Telugu (te-IN)
   - Turkish (tr)
   - Ukrainian (uk-UA)

   What remains:
   - English (en)
   - Hebrew (iw) - enforced via locale filters

   Impact: MAJOR - Non-English/Hebrew users lose store descriptions


5. HISTORY AND STATS BUTTONS
   --------------------------
   REMOVED: Quick access buttons from toolbar

   What was removed:
   - History button (clock icon) from search toolbar
   - Stats button (graph icon) from search toolbar

   What remains:
   - Features may still be accessible through other menus
   - Only Settings button remains in toolbar

   Impact: MINOR - Reduced discoverability, but features may still exist


6. PROGUARD RULES (CODE OBFUSCATION)
   ----------------------------------
   REMOVED: 109 lines of ProGuard configuration

   What was removed:
   - Kotlin Serialization keep rules
   - NewPipeExtractor keep rules
   - Queue Persistence keep rules
   - UCrop library keep rules
   - Logging optimization rules
   - Many dontwarn statements

   What remains:
   - Only 4 lines for Mozilla JavaScript engine

   Impact: CRITICAL - App may crash in release builds due to over-aggressive code stripping
            Serialization, queue persistence, and third-party libraries may break


7. PROJECT DOCUMENTATION
   ----------------------
   REMOVED: Developer documentation files

   What was removed:
   - CLAUDE.md (entire project documentation - 385 lines)
   - SPLASH_SCREEN_ROLLBACK.md
   - Hebrew translation strings (values-iw/metrolist_strings.xml)

   Impact: MEDIUM - Loss of project documentation for developers


================================================================================
                        MAJOR FEATURES ADDED
================================================================================

1. AUDIO-ONLY PLAYBACK
   --------------------
   ADDED: Stripped video rendering capabilities

   What was added:
   - AudioOnlyRenderersFactory.kt (new file)
   - Disables all video rendering in ExoPlayer
   - Reduces app size and resource usage

   What changed:
   - MusicService now uses AudioOnlyRenderersFactory
   - Video renderers are explicitly skipped

   Impact: POSITIVE - Smaller footprint, faster performance, but no video playback


2. APP REBRANDING
   --------------
   CHANGED: App name from "Metrolist" to "Zemer"

   What changed:
   - App title: "Metrolist" → "Zemer"
   - Debug app name: "Metrolist Debug" → "Zemer"
   - About screen description: "An audio-first YouTube Music experience"
   - Modernized About screen UI with new layout

   Impact: COSMETIC - Complete rebranding


3. ANDROIDX MIGRATION
   -------------------
   REPLACED: Guava library with AndroidX alternatives

   What was removed:
   - com.google.guava:guava dependency
   - kotlinx-coroutines-guava dependency
   - MoreExecutors.directExecutor() usage

   What was added:
   - androidx.concurrent:concurrent-futures-ktx
   - com.google.guava:listenablefuture (empty stub to avoid conflicts)
   - FutureUtils.kt - custom implementation of future utilities
   - Direct executor implementation (Executor { runnable -> runnable.run() })

   Impact: POSITIVE - Better AndroidX integration, but requires thorough testing


4. LAUNCHER ICON UPDATES
   ----------------------
   CHANGED: All launcher icons updated

   What changed:
   - ic_launcher_background.xml (new drawable)
   - All density mipmap files updated (hdpi, mdpi, xhdpi, xxhdpi, xxxhdpi)
   - Added foreground webp files for all densities
   - Removed Android 12+ specific icons (mipmap-anydpi-v31)

   Impact: COSMETIC - New app icon appearance


5. BUILD CONFIGURATION
   -------------------
   CHANGED: Simplified build system

   What changed:
   - MultiDex enabled
   - Locale filtering enforced (English + Hebrew only)
   - compose.ui.tooling moved to debugImplementation (not in release)
   - Baseline profiles added (app-universal-release.dm files)

   Impact: MIXED - Cleaner builds but larger APK, faster debug builds


================================================================================
                        DEPENDENCY CHANGES
================================================================================

REMOVED:
- com.google.guava:guava (33.5.0-android)
- kotlinx-coroutines-guava (1.10.2)

ADDED:
- com.google.guava:listenablefuture (9999.0-empty-to-avoid-conflict-with-guava)
- androidx.concurrent:concurrent-futures-ktx (already present, now primary)

MOVED:
- compose.ui.tooling → debugImplementation only (not in release builds)


================================================================================
                        CODE CHANGES SUMMARY
================================================================================

FILES MODIFIED: 42 files
FILES ADDED: 5 files
FILES DELETED: 48 files

Key Files Modified:
- MainActivity.kt (-109 lines) - Removed online search UI and toggle
- MusicService.kt - Changed to AudioOnlyRenderersFactory, removed Guava
- AboutScreen.kt (major refactor) - Complete redesign of About page
- SplashScreen.kt - Removed skip button, changed to percentage progress
- PreferenceKeys.kt (-13 lines) - Removed SearchSource enum
- app/build.gradle.kts - Removed ABI flavors, added locale filters
- proguard-rules.pro (-109 lines) - Stripped most ProGuard rules

New Files Added:
- AudioOnlyRenderersFactory.kt - Video rendering disabler
- FutureUtils.kt - Guava replacement utilities
- ic_launcher_background.xml - New launcher background
- Foreground launcher icons (5 densities)
- Baseline profile files (2 files)


================================================================================
                        RISK ASSESSMENT
================================================================================

CRITICAL RISKS:
1. ProGuard rules removal may cause RELEASE BUILD CRASHES
   - Serialization may fail (queue persistence broken)
   - NewPipeExtractor may break (YouTube API calls fail)
   - UCrop image editing may crash

2. Online search removal eliminates PRIMARY MUSIC DISCOVERY
   - Users cannot search YouTube Music catalog
   - Limited to pre-downloaded library only
   - Major functionality loss

HIGH RISKS:
3. Guava → AndroidX migration needs extensive testing
   - Future/callback conversions may behave differently
   - Executor implementations changed
   - Coroutine integration rewritten

4. Language support reduction alienates international users
   - Only English + Hebrew supported
   - 24+ languages removed from store listings

MEDIUM RISKS:
5. Splash screen cannot be skipped
   - Users must wait for whitelist sync every time
   - Poor UX if sync is slow or fails

6. Universal-only builds increase APK size
   - All users download all ABIs (~2-3x larger APK)
   - Wasted storage on user devices


================================================================================
                        RECOMMENDATIONS
================================================================================

BEFORE MERGING TO MAIN:

1. TEST RELEASE BUILDS EXTENSIVELY
   - Restore ProGuard rules for critical components
   - Test queue persistence (save/restore playback state)
   - Test YouTube API calls (NewPipeExtractor)
   - Test image cropping (UCrop)

2. VERIFY CORE FUNCTIONALITY
   - Test AudioOnlyRenderersFactory (ensure audio works)
   - Test FutureUtils replacements (coroutine futures)
   - Verify MediaSession callbacks still work

3. CONSIDER REVERTING:
   - ProGuard rules removal (keep critical rules)
   - Online search removal (major feature loss)
   - Splash screen skip button (better UX)
   - Multi-language metadata (international support)

4. CHERRY-PICK CAREFULLY:
   - Accept: AudioOnlyRenderersFactory (good optimization)
   - Accept: FutureUtils (but test thoroughly)
   - Accept: About screen redesign (cosmetic improvement)
   - Reject: ProGuard rules removal (too risky)
   - Reject: Online search removal (feature loss)
   - Review: ABI flavor removal (consider keeping)


================================================================================
                        COMMIT BREAKDOWN
================================================================================

Commit: 5a887184 - "Updates By TripleU"
- Initial changes and rebranding

Commit: 51c85683 - "replaced guava with androidx"
- Removed Guava dependencies
- Added FutureUtils.kt

Commit: 4e2bc0ba - "strippped media3-exoplayer for non video playing varient"
- Added AudioOnlyRenderersFactory.kt
- Modified MusicService to use audio-only rendering

Commit: 8de6879f - "Slight fixez"
- Minor fixes

Commit: 18f042ce - "removed abi filters..."
- Removed all ABI flavor variants
- Simplified build configuration

Commit: 322141bd - "search refinements"
- Removed online search functionality
- Removed history/stats toolbar buttons
- Simplified search to local-only


================================================================================
                            END OF REPORT
================================================================================
